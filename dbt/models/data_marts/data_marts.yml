version: 2

models:
  - name: agg_sales_monthly
    description: |
      This model calculates the total monthly revenue by year, month, and quarter. 
      It joins the transaction fact table (`transaction_fct`) with the date dimension table (`date_dim`), 
      and calculates the total revenue for each period by summing the product of quantity and price.
    columns:

      - name: year
        description: "The year of the transaction, extracted from the date dimension."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

      - name: month
        description: "The month of the transaction, extracted from the date dimension."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

      - name: quarter
        description: "The quarter of the year, extracted from the date dimension."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

      - name: monthly_revenue
        description: "The total revenue for the month, calculated by summing the product of quantity and price."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

  - name: agg_sales_customer
    description: |
      This model calculates the total revenue for each customer by joining the transaction fact table (`transaction_fct`) 
      with the customer dimension table (`customer_dim`). The revenue is the sum of the product of quantity and price.
    columns:

      - name: customer_id
        description: "The unique identifier for the customer."
        tests:
          - not_null:
              severity: error
              error_if: ">20"
          - unique

      - name: revenue
        description: "The total revenue generated by the customer, calculated by summing the product of quantity and price."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

  - name: agg_sales_country
    description: |
      This model calculates the total revenue for each country by joining the transaction fact table (`transaction_fct`) 
      with the location dimension table (`location_dim`). The revenue is calculated by summing the product of quantity and price, 
      grouped by country.
    columns:

      - name: country
        description: "The name of the country where the transactions occurred."
        tests:
          - not_null:
              severity: error
              error_if: ">20"

      - name: monthly_revenue
        description: "The total revenue for each country, calculated by summing the product of quantity and price."
        tests:
          - not_null:
              severity: error
              error_if: ">20"